import openvas

# OpenVAS scanner function
def openvas_scan(target_ip):
    scanner = openvas.Scanner()
    scan_config = scanner.get_scan_config('Full and very deep')
    scan_target = scanner.get_target(target_ip)
    scan_task = scanner.create_task(scan_config, scan_target)
    scanner.start_task(scan_task)
    return scanner.get_task_results(scan_task)

# Example usage
target_ip = '192.168.1.100'
vuln_results = openvas_scan(target_ip)
print(vuln_results)
